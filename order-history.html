<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Order History</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
</head>
<body style="background:#000; color:#fff; padding:20px;">

  <div id="header"></div>
  <h2>Order History</h2>
  <table border="1" style="width:100%; color:#fff; text-align:center;" id="orders"></table>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAyhjOsIXNAkBglpRllt0OZIOJYpdB_9-8",
      authDomain: "diamond-recharge-f7f59.firebaseapp.com",
      projectId: "diamond-recharge-f7f59",
      storageBucket: "diamond-recharge-f7f59.firebasestorage.app",
      messagingSenderId: "657717928489",
      appId: "1:657717928489:web:70431ebc9afb7002d4b238",
      measurementId: "G-TDK78BQ8SQ"
    };
    firebase.initializeApp(firebaseConfig);
    const auth=firebase.auth();

    auth.onAuthStateChanged(user=>{
      if(!user) window.location.href="login.html";
      else loadOrders();
    });

    fetch("header.html").then(r=>r.text()).then(h=>document.getElementById("header").innerHTML=h);

    async function loadOrders(){
      const res=await fetch("https://script.google.com/macros/s/AKfycbypLjvDmPyBh68pwoeXuR7lFyc8qb8rimTLl1KYTKPoZ0lmfkvs-Xz6X3f-sNTLR91wqQ/exec");
      const data=await res.json();
      if(data.ok){
        let html="<tr>";
        data.rows[0].forEach(h=>html+="<th>"+h+"</th>");
        html+="</tr>";
        data.rows.slice(1).forEach(r=>{
          html+="<tr>"+r.map(c=>"<td>"+c+"</td>").join("")+"</tr>";
        });
        document.getElementById("orders").innerHTML=html;
      }
    }
  </script>
</body>
</html>