<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SARKAR TELECOM Header</title>
  <script type="module">
    // Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // à¦†à¦ªà¦¨à¦¾à¦° Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyDJRm9-jRkxVrTLYBzK1gGrRmAEu29jVrU",
      authDomain: "diamond-recharge-f7f59.firebaseapp.com",
      projectId: "diamond-recharge-f7f59",
      storageBucket: "diamond-recharge-f7f59.firebasestorage.app",
      messagingSenderId: "657717928489",
      appId: "1:657717928489:web:70431ebc9afb7002d4b238",
      measurementId: "G-TDK78BQ8SQ"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Auth state listener
    onAuthStateChanged(auth, (user) => {
      if (user) {
        document.getElementById("welcomeUser").textContent =
          `Welcome ${user.displayName || "User"} to Sarkar Telecom`;
        document.getElementById("userEmail").textContent = user.email;

        // Firestore à¦¥à§‡à¦•à§‡ balance à¦²à¦¾à¦‡à¦­ update
        const uref = doc(db, "users", user.uid);
        onSnapshot(uref, (snap) => {
          if (snap.exists()) {
            const data = snap.data();
            document.getElementById("userBalance").textContent =
              `ðŸ’Ž ${data.balance || 0}`;
          }
        });

        // à¦‡à¦‰à¦œà¦¾à¦° photo à¦¥à¦¾à¦•à¦²à§‡ show à¦•à¦°à¦¬
        if (user.photoURL) {
          document.getElementById("userLogo").src = user.photoURL;
        }
      } else {
        document.getElementById("welcomeUser").textContent = "Not logged in";
        document.getElementById("userBalance").textContent = "";
      }
    });

    // Logout
    window.doLogout = async () => {
      await signOut(auth);
      localStorage.clear();
      alert("Logged out successfully!");
      window.location.href = "login.html";
    };
  </script>
  <style>
    :root {
      --bg:#0f1115; --card:#171a21; --text:#e7eaf0;
      --accent:#06b6d4; --bad:#ef4444;
    }
    body { margin:0; font-family:Segoe UI, sans-serif; background:var(--bg); color:var(--text); }
    header {
      background:var(--card);
      border-bottom:1px solid #202635;
      padding:10px 16px;
      display:flex; flex-direction:column; gap:10px;
    }
    /* Top Row */
    .top-row {
      display:flex; justify-content:space-between; align-items:center;
      flex-wrap:wrap; gap:10px;
    }
    .site-name {
      font-size:20px; font-weight:800;
      background:linear-gradient(90deg,#06b6d4,#3b82f6,#9333ea);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    .user-box {
      display:flex; align-items:center; gap:10px;
    }
    #userLogo {
      width:36px; height:36px; border-radius:50%; border:2px solid var(--accent);
      object-fit:cover;
    }
    .user-info { font-size:14px; }
    .logout-btn {
      background:var(--bad); border:none; padding:6px 12px; border-radius:8px;
      cursor:pointer; color:#fff; font-weight:600;
    }
    /* Bottom Row nav */
    nav {
      display:flex; flex-wrap:wrap; gap:10px; justify-content:center;
    }
    nav a {
      background:#1f2430; padding:6px 12px; border-radius:8px;
      text-decoration:none; color:var(--text); font-weight:500; font-size:14px;
    }
    nav a:hover { background:var(--accent); color:#000; }
    /* Responsive */
    @media(max-width:600px){
      .top-row { flex-direction:column; align-items:flex-start; }
      .user-box { align-items:flex-start; }
      nav { flex-direction:column; width:100%; }
      nav a { width:100%; text-align:center; }
    }
  </style>
</head>
<body>
  <header>
    <!-- First Line -->
    <div class="top-row">
      <div class="site-name">SARKAR TELECOM</div>
      <div class="user-box">
        <img id="userLogo" src="https://via.placeholder.com/36" alt="User">
        <div>
          <div id="welcomeUser" class="user-info">Loading...</div>
          <div id="userEmail" class="user-info"></div>
          <div id="userBalance" class="user-info"></div>
        </div>
        <button class="logout-btn" onclick="doLogout()">Logout</button>
      </div>
    </div>
    <!-- Second Line -->
    <nav>
      <a href="dashboard.html">Dashboard</a>
      <a href="order.html">Order</a>
      <a href="order-history.html">Order History</a>
      <a href="profile.html">Profile</a>
    </nav>
  </header>
</body>
</html>