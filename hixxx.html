<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞</title>
  <style>
    body { font-family: Arial, sans-serif; background:#0f1115; color:#eee; padding:20px; }
    h1 { color:#06b6d4; }
    .order { background:#171a21; margin:10px 0; padding:10px; border-radius:8px; }
    .waiting { color:orange; }
    .complete { color:lime; }
    .cancel { color:red; }
  </style>
</head>
<body>
  <h1>üìã ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞</h1>
  <div id="orders">‚è≥ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBIIOv-2Laqugv5_HAIRNJllp8YUfYndF8",
      authDomain: "diamond-recharge-f7f59.firebaseapp.com",
      projectId: "diamond-recharge-f7f59",
      storageBucket: "diamond-recharge-f7f59.appspot.com",
      messagingSenderId: "657717928489",
      appId: "1:657717928489:web:70431ebc9afb7002d4b238"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR4owbSc_h38ouaktOU30TYqH6wy93qYjmW0G5GWXhsBMzsrVSaWzPtVPA7YpyOUmlEpStByT8TxG0-/pub?gid=1098128992&single=true&output=csv";

    function renderOrders(userEmail, data) {
      const orders = data
        .filter(o => o.Email === userEmail)
        .map(o => `
          <div class="order ${o.Status.toLowerCase()}">
            <b>${o.Timestamp}</b><br>
            ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞: ${o.Number}<br>
            üíé ${o.Amount}<br>
            ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏: ${o.Status}
          </div>
        `).join("");
      document.getElementById("orders").innerHTML = orders || "<p>‡¶ï‡ßã‡¶®‡¶ì ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§</p>";
    }

    onAuthStateChanged(auth, user => {
      if (!user) {
        document.getElementById("orders").innerHTML = "<p>‚ùå ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p>";
        return;
      }
      fetch(SHEET_URL)
        .then(res => res.text())
        .then(csv => {
          const rows = csv.split("\n").slice(1);
          const data = rows.map(r => {
            const c = r.split(",");
            return {
              Timestamp: c[0], Number: c[1], Amount: c[2], Email: c[3], Status: c[4]
            };
          });
          renderOrders(user.email, data);
        });
    });
  </script>
</body>
</html>